@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@

@using MVCWebApp_CRUD_session.Models
@using Microsoft.AspNetCore.Http

@using MVCWebApp_CRUD_session.Services
@inject IHttpContextAccessor HttpContextAccessor
@model List<Course>
@{
    var cart = ViewBag.Cart as List<Course> ?? new List<Course>();
    // List<Course> cart = new List<Course>();
    // var session = HttpContextAccessor?.HttpContext?.Session;
    // if (session != null)
    // {
    //     var retrievedCart = SessionServices.GetCart(session) ?? new List<Course>();
    //     if (retrievedCart != null)
    //     {
    //         cart = retrievedCart;

    //     }
    // }


}

@if (cart.Count > 0)
{
<h2>Number of courses: @cart.Count</h2>
<form action="/Course/ClearCart" method="post" style="margin-bottom: 20px;">
    <button type="submit" class="btn btn-danger">Remove all</button>
</form>

<table class="table">
    <tr>
        <th>CourseID</th>
        <th>Title</th>
        <th>StartDate</th>
        <th>SubjectName</th>
       
        <th>Action</th>
    </tr>
  
        @for (int i = 0; i < cart.Count; i++)
        {
            Course c = cart[i];
            // if (c == null)
            // {
            //     <H1>Found null</H1>
            //     break;
            // }
            // var c = cart[i];
            // if (c == null)
            // {
            //     <H1>Found null</H1>
            //     break;
            // })
    
        // if (c == null)
        // {
        //     <H1>Found null</H1>
        //     break;
        //     }
            <tr>
                <td>@c.Id</td>
                <td>@c.Title</td>
                <td>@c.StartDate</td>
                <td>@c.EndDate</td>
            <td>@c.SubjectId</td>
               
                <td>
                    <form action="/Course/RemoveFromCart" method="post" style="display:inline;">
                        <input type="hidden" name="id" value="@c.Id" />
                        <button type="submit" class="btn btn-danger">Remove</button>
                    </form>
                </td>
            </tr>
        }
    </table>
}
else
{
    <p>Cart empty.</p>
}

<a href="/Course/List" class="btn btn-primary">Return courses</a>
